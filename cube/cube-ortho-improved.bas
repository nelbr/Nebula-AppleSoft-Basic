10 HGR : HGR2 
15 SZ = 50 : CX = 140 : CY = 96 : SC = 0 : ANGLE = 0.08
20 DIM PTS(7,2) : DIM RZP(7,2) : DIM RYP(7,2) : DIM RXP(7,2) : DIM ROT(2,2) 
30 GOSUB 5000
40 CS = COS(ANGLE) 
50 SN = SIN(ANGLE)
60 ROT(0,0) =  CS * CS : ROT(1,0) = -SN : ROT(2,0) = SN * CS
70 ROT(0,1) =  SN * CS : ROT(1,1) =  CS : ROT(2,1) = SN * SN
80 ROT(0,2) = -SN      : ROT(1,2) =   0 : ROT(2,2) = CS
90 POKE 230, 32

100 REM DRAW LOOP
105 CALL 62450
110 HCOLOR=3
115 IF SC=0 THEN GOSUB 2000 : GOSUB 6000 
120 IF SC=1 THEN GOSUB 3000 : GOSUB 7000 
150 GOSUB 1000
160 GOTO 100

500 X1 = RYP(A,0) + CX
510 Y1 = RYP(A,1) + CY
520 X2 = RYP(B,0) + CX
530 Y2 = RYP(B,1) + CY
540 HPLOT X1,Y1 TO X2,Y2
550 RETURN 

600 X1 = PTS(A,0) + CX
610 Y1 = PTS(A,1) + CY
620 X2 = PTS(B,0) + CX
630 Y2 = PTS(B,1) + CY
640 HPLOT X1,Y1 TO X2,Y2
650 RETURN 

1000 SC = NOT SC
1010 POKE 49236 + NOT SC,0
1020 POKE 230,32 + 32 * SC
1030 RETURN 

2000 REM ROTATE CUBE
2020 FOR N = 0 TO 7
2030 RYP(N,0) = ROT(0,0) * PTS(N,0) + ROT(1,0) * PTS(N,1) + ROT(2,0) * PTS(N,2)  
2040 RYP(N,1) = ROT(0,1) * PTS(N,0) + ROT(1,1) * PTS(N,1) + ROT(2,1) * PTS(N,2)
2050 RYP(N,2) = ROT(0,2) * PTS(N,0) + ROT(2,2) * PTS(N,2)
2060 NEXT N
2070 RETURN 

3000 REM ROTATE CUBE
3020 FOR N = 0 TO 7
3030 PTS(N,0) = ROT(0,0) * RYP(N,0) + ROT(1,0) * RYP(N,1) + ROT(2,0) * RYP(N,2)  
3040 PTS(N,1) = ROT(0,1) * RYP(N,0) + ROT(1,1) * RYP(N,1) + ROT(2,1) * RYP(N,2)
3050 PTS(N,2) = ROT(0,2) * RYP(N,0) + ROT(2,2) * RYP(N,2)
3060 NEXT N
3070 RETURN 

5000 PTS(0,0) = -SZ: PTS(0,1) = -SZ : PTS(0,2) = -SZ
5010 PTS(1,0) =  SZ: PTS(1,1) = -SZ : PTS(1,2) = -SZ
5020 PTS(2,0) =  SZ: PTS(2,1) =  SZ : PTS(2,2) = -SZ
5030 PTS(3,0) = -SZ: PTS(3,1) =  SZ : PTS(3,2) = -SZ
5040 PTS(4,0) = -SZ: PTS(4,1) = -SZ : PTS(4,2) =  SZ
5050 PTS(5,0) =  SZ: PTS(5,1) = -SZ : PTS(5,2) =  SZ
5060 PTS(6,0) =  SZ: PTS(6,1) =  SZ : PTS(6,2) =  SZ
5070 PTS(7,0) = -SZ: PTS(7,1) =  SZ : PTS(7,2) =  SZ
5080 FOR M=0 TO 7 : FOR N=0 TO 2 : RPY(M,N) = PTS(M,N) : NEXT : NEXT
5090 RETURN 

6000 REM DRAW LINES
6010 A = 0 : B = 1 : GOSUB 500
6020 A = 1 : B = 2 : GOSUB 500
6030 A = 2 : B = 3 : GOSUB 500
6040 A = 3 : B = 0 : GOSUB 500
6050 A = 4 : B = 5 : GOSUB 500
6060 A = 5 : B = 6 : GOSUB 500
6070 A = 6 : B = 7 : GOSUB 500
6080 A = 7 : B = 4 : GOSUB 500
6090 A = 0 : B = 4 : GOSUB 500
6100 A = 1 : B = 5 : GOSUB 500
6110 A = 2 : B = 6 : GOSUB 500
6120 A = 3 : B = 7 : GOSUB 500
6130 RETURN 

7000 REM DRAW LINES
7010 A = 0 : B = 1 : GOSUB 600
7020 A = 1 : B = 2 : GOSUB 600
7030 A = 2 : B = 3 : GOSUB 600
7040 A = 3 : B = 0 : GOSUB 600
7050 A = 4 : B = 5 : GOSUB 600
7060 A = 5 : B = 6 : GOSUB 600
7070 A = 6 : B = 7 : GOSUB 600
7080 A = 7 : B = 4 : GOSUB 600
7090 A = 0 : B = 4 : GOSUB 600
7100 A = 1 : B = 5 : GOSUB 600
7110 A = 2 : B = 6 : GOSUB 600
7120 A = 3 : B = 7 : GOSUB 600
7130 RETURN 
